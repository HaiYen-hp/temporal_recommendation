2024-06-14 04:54:33 - 2024-06-14 04:54:33.765279: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
2024-06-14 04:54:33 - To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-06-14 04:54:33 - 2024-06-14 04:54:33.921275: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-06-14 04:54:34 - 2024-06-14 04:54:34.606103: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2024-06-14 04:54:34 - 2024-06-14 04:54:34.606188: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2024-06-14 04:54:34 - 2024-06-14 04:54:34.606197: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2024-06-14 04:54:35 - 2024-06-14 04:54:35.517843: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
2024-06-14 04:54:35 - To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-06-14 04:54:48 - 2024-06-14 04:54:48.869473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9633 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:04:00.0, compute capability: 7.5
2024-06-14 04:54:48 - 2024-06-14 04:54:48.871355: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 271 MB memory:  -> device: 1, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:05:00.0, compute capability: 7.5
2024-06-14 04:54:48 - 2024-06-14 04:54:48.873488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 9302 MB memory:  -> device: 2, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:08:00.0, compute capability: 7.5
2024-06-14 04:54:48 - 2024-06-14 04:54:48.875451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 9633 MB memory:  -> device: 3, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:82:00.0, compute capability: 7.5
2024-06-14 04:54:48 - 2024-06-14 04:54:48.877278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:4 with 4606 MB memory:  -> device: 4, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:86:00.0, compute capability: 7.5
2024-06-14 04:54:48 - 2024-06-14 04:54:48.879054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:5 with 4012 MB memory:  -> device: 5, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:89:00.0, compute capability: 7.5
2024-06-14 04:54:48 - 2024-06-14 04:54:48.880700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:6 with 3854 MB memory:  -> device: 6, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:8a:00.0, compute capability: 7.5
2024-06-14 04:54:49 - 2024-06-14 04:54:49.184959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9633 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:04:00.0, compute capability: 7.5
2024-06-14 04:54:49 - 2024-06-14 04:54:49.185776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 271 MB memory:  -> device: 1, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:05:00.0, compute capability: 7.5
2024-06-14 04:54:49 - 2024-06-14 04:54:49.186937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 9302 MB memory:  -> device: 2, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:08:00.0, compute capability: 7.5
2024-06-14 04:54:49 - 2024-06-14 04:54:49.188090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 9633 MB memory:  -> device: 3, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:82:00.0, compute capability: 7.5
2024-06-14 04:54:49 - 2024-06-14 04:54:49.189065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:4 with 4606 MB memory:  -> device: 4, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:86:00.0, compute capability: 7.5
2024-06-14 04:54:49 - 2024-06-14 04:54:49.190029: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:5 with 4012 MB memory:  -> device: 5, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:89:00.0, compute capability: 7.5
2024-06-14 04:54:49 - 2024-06-14 04:54:49.190991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:6 with 3854 MB memory:  -> device: 6, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:8a:00.0, compute capability: 7.5
2024-06-14 04:54:49 - 2024-06-14 04:54:49.220580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /device:GPU:0 with 9633 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:04:00.0, compute capability: 7.5
2024-06-14 04:54:49 - 2024-06-14 04:54:49.221406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /device:GPU:1 with 271 MB memory:  -> device: 1, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:05:00.0, compute capability: 7.5
2024-06-14 04:54:49 - 2024-06-14 04:54:49.222596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /device:GPU:2 with 9302 MB memory:  -> device: 2, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:08:00.0, compute capability: 7.5
2024-06-14 04:54:49 - 2024-06-14 04:54:49.223763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /device:GPU:3 with 9633 MB memory:  -> device: 3, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:82:00.0, compute capability: 7.5
2024-06-14 04:54:49 - 2024-06-14 04:54:49.224745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /device:GPU:4 with 4606 MB memory:  -> device: 4, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:86:00.0, compute capability: 7.5
2024-06-14 04:54:49 - 2024-06-14 04:54:49.225740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /device:GPU:5 with 4012 MB memory:  -> device: 5, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:89:00.0, compute capability: 7.5
2024-06-14 04:54:49 - 2024-06-14 04:54:49.226722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /device:GPU:6 with 3854 MB memory:  -> device: 6, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:8a:00.0, compute capability: 7.5
2024-06-14 04:55:40 - 2024-06-14 04:55:40.367761: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9633 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:04:00.0, compute capability: 7.5
2024-06-14 04:55:40 - 2024-06-14 04:55:40.368615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 271 MB memory:  -> device: 1, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:05:00.0, compute capability: 7.5
2024-06-14 04:55:40 - 2024-06-14 04:55:40.369770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 9302 MB memory:  -> device: 2, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:08:00.0, compute capability: 7.5
2024-06-14 04:55:40 - 2024-06-14 04:55:40.371008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 9633 MB memory:  -> device: 3, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:82:00.0, compute capability: 7.5
2024-06-14 04:55:40 - 2024-06-14 04:55:40.372023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:4 with 4606 MB memory:  -> device: 4, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:86:00.0, compute capability: 7.5
2024-06-14 04:55:40 - 2024-06-14 04:55:40.373040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:5 with 4012 MB memory:  -> device: 5, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:89:00.0, compute capability: 7.5
2024-06-14 04:55:40 - 2024-06-14 04:55:40.374094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:6 with 3854 MB memory:  -> device: 6, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:8a:00.0, compute capability: 7.5
2024-06-14 04:55:41 - List GPU devices used
2024-06-14 04:55:41 - [name: "/device:CPU:0"
2024-06-14 04:55:41 - device_type: "CPU"
2024-06-14 04:55:41 - memory_limit: 268435456
2024-06-14 04:55:41 - locality {
2024-06-14 04:55:41 - }
2024-06-14 04:55:41 - incarnation: 15764155367906852402
2024-06-14 04:55:41 - xla_global_id: -1
2024-06-14 04:55:41 - , name: "/device:GPU:0"
2024-06-14 04:55:41 - device_type: "GPU"
2024-06-14 04:55:41 - memory_limit: 10101653504
2024-06-14 04:55:41 - locality {
2024-06-14 04:55:41 -   bus_id: 1
2024-06-14 04:55:41 -   links {
2024-06-14 04:55:41 -   }
2024-06-14 04:55:41 - }
2024-06-14 04:55:41 - incarnation: 7801965314614160130
2024-06-14 04:55:41 - physical_device_desc: "device: 0, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:04:00.0, compute capability: 7.5"
2024-06-14 04:55:41 - xla_global_id: 416903419
2024-06-14 04:55:41 - , name: "/device:GPU:1"
2024-06-14 04:55:41 - device_type: "GPU"
2024-06-14 04:55:41 - memory_limit: 284884992
2024-06-14 04:55:41 - locality {
2024-06-14 04:55:41 -   bus_id: 1
2024-06-14 04:55:41 -   links {
2024-06-14 04:55:41 -     link {
2024-06-14 04:55:41 -       device_id: 2
2024-06-14 04:55:41 -       type: "StreamExecutor"
2024-06-14 04:55:41 -       strength: 1
2024-06-14 04:55:41 -     }
2024-06-14 04:55:41 -   }
2024-06-14 04:55:41 - }
2024-06-14 04:55:41 - incarnation: 16461670323003465163
2024-06-14 04:55:41 - physical_device_desc: "device: 1, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:05:00.0, compute capability: 7.5"
2024-06-14 04:55:41 - xla_global_id: 2144165316
2024-06-14 04:55:41 - , name: "/device:GPU:2"
2024-06-14 04:55:41 - device_type: "GPU"
2024-06-14 04:55:41 - memory_limit: 9754574848
2024-06-14 04:55:41 - locality {
2024-06-14 04:55:41 -   bus_id: 1
2024-06-14 04:55:41 -   links {
2024-06-14 04:55:41 -     link {
2024-06-14 04:55:41 -       device_id: 1
2024-06-14 04:55:41 -       type: "StreamExecutor"
2024-06-14 04:55:41 -       strength: 1
2024-06-14 04:55:41 -     }
2024-06-14 04:55:41 -   }
2024-06-14 04:55:41 - }
2024-06-14 04:55:41 - incarnation: 16959971688410859523
2024-06-14 04:55:41 - physical_device_desc: "device: 2, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:08:00.0, compute capability: 7.5"
2024-06-14 04:55:41 - xla_global_id: 1651660799
2024-06-14 04:55:41 - , name: "/device:GPU:3"
2024-06-14 04:55:41 - device_type: "GPU"
2024-06-14 04:55:41 - memory_limit: 10101653504
2024-06-14 04:55:41 - locality {
2024-06-14 04:55:41 -   bus_id: 2
2024-06-14 04:55:41 -   numa_node: 1
2024-06-14 04:55:41 -   links {
2024-06-14 04:55:41 -     link {
2024-06-14 04:55:41 -       device_id: 4
2024-06-14 04:55:41 -       type: "StreamExecutor"
2024-06-14 04:55:41 -       strength: 1
2024-06-14 04:55:41 -     }
2024-06-14 04:55:41 -   }
2024-06-14 04:55:41 - }
2024-06-14 04:55:41 - incarnation: 4225756950307466986
2024-06-14 04:55:41 - physical_device_desc: "device: 3, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:82:00.0, compute capability: 7.5"
2024-06-14 04:55:41 - xla_global_id: 878896533
2024-06-14 04:55:41 - , name: "/device:GPU:4"
2024-06-14 04:55:41 - device_type: "GPU"
2024-06-14 04:55:41 - memory_limit: 4830461952
2024-06-14 04:55:41 - locality {
2024-06-14 04:55:41 -   bus_id: 2
2024-06-14 04:55:41 -   numa_node: 1
2024-06-14 04:55:41 -   links {
2024-06-14 04:55:41 -     link {
2024-06-14 04:55:41 -       device_id: 3
2024-06-14 04:55:41 -       type: "StreamExecutor"
2024-06-14 04:55:41 -       strength: 1
2024-06-14 04:55:42 -     }
2024-06-14 04:55:42 -   }
2024-06-14 04:55:42 - }
2024-06-14 04:55:42 - incarnation: 13439181344930816108
2024-06-14 04:55:42 - physical_device_desc: "device: 4, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:86:00.0, compute capability: 7.5"
2024-06-14 04:55:42 - xla_global_id: 615190153
2024-06-14 04:55:42 - , name: "/device:GPU:5"
2024-06-14 04:55:42 - device_type: "GPU"
2024-06-14 04:55:42 - memory_limit: 4207607808
2024-06-14 04:55:42 - locality {
2024-06-14 04:55:42 -   bus_id: 2
2024-06-14 04:55:42 -   numa_node: 1
2024-06-14 04:55:42 -   links {
2024-06-14 04:55:42 -     link {
2024-06-14 04:55:42 -       device_id: 6
2024-06-14 04:55:42 -       type: "StreamExecutor"
2024-06-14 04:55:42 -       strength: 1
2024-06-14 04:55:42 -     }
2024-06-14 04:55:42 -   }
2024-06-14 04:55:42 - }
2024-06-14 04:55:42 - incarnation: 7384036289851645867
2024-06-14 04:55:42 - physical_device_desc: "device: 5, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:89:00.0, compute capability: 7.5"
2024-06-14 04:55:42 - xla_global_id: 1769886423
2024-06-14 04:55:42 - , name: "/device:GPU:6"
2024-06-14 04:55:42 - device_type: "GPU"
2024-06-14 04:55:42 - memory_limit: 4041932800
2024-06-14 04:55:42 - locality {
2024-06-14 04:55:42 -   bus_id: 2
2024-06-14 04:55:42 -   numa_node: 1
2024-06-14 04:55:42 -   links {
2024-06-14 04:55:42 -     link {
2024-06-14 04:55:42 -       device_id: 5
2024-06-14 04:55:42 -       type: "StreamExecutor"
2024-06-14 04:55:42 -       strength: 1
2024-06-14 04:55:42 -     }
2024-06-14 04:55:42 -   }
2024-06-14 04:55:42 - }
2024-06-14 04:55:42 - incarnation: 17145200528234571593
2024-06-14 04:55:42 - physical_device_desc: "device: 6, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:8a:00.0, compute capability: 7.5"
2024-06-14 04:55:42 - xla_global_id: 893286608
2024-06-14 04:55:42 - ]
2024-06-14 04:55:42 - Traceback (most recent call last):
2024-06-14 04:55:42 -   File "/home/yenlh/temporal_recommendation/TimelyRec/train.py", line 87, in <module>
2024-06-14 04:55:42 -     tr_dataset['timestamp_hour'] = (tr_dataset['timestamp'] / 3600).astype(int)
2024-06-14 04:55:42 -   File "/home/yenlh/temporal_recommendation/TimelyRec/model.py", line 280, in TimelyRec
2024-06-14 04:55:42 -     create_embedding(monthEmbeddings, monthInput, ratio, num_of_date=12)
2024-06-14 04:55:42 - TypeError: create_embedding() missing 1 required positional argument: 'ratio'
